<!DOCTYPE html>
<html>

<meta charset="utf-8">
<script src="https://d3js.org/d3.v6.js"></script>

<div id="vis"></div>

<script>

    const margin = {top: 10, right: 20, bottom: 30, left: 50},
        total_width = document.getElementById('vis')
        .clientWidth,
        total_height = document.getElementById('vis')
        .clientHeight,
        width = total_width - margin.left - margin.right,
        height = total_height - margin.top - margin.bottom;
    
    const svg = d3.select("#vis")
      .append("svg")
        .attr("width", total_width)
        .attr("height", total_height)
      .append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);

    d3.csv("https://raw.githubusercontent.com/wan-wang/data-visualization/main/data.csv").then( function(data) {
    
      // X axis
      const x = d3.scaleLog()
        .domain([570000, 40000000])
        .range([ 0, width ]);
      svg.append("g")
        .attr("transform", `translate(0, ${height})`)
        .call(d3.axisBottom(x));
    
      // Y axis
      const y = d3.scaleLog()
        .domain([450, 9700000])
        .range([ height, 0]);
      svg.append("g")
        .call(d3.axisLeft(y));
    
      // bubble size
      const z = d3.scaleLinear()
        .domain([450, 353200])
        .range([ 1, 40]);
    
      // Add dots
      svg.append('g')
        .selectAll("dot")
        .data(data)
        .join("circle")
          .attr("cx", d => x(d.population))
          .attr("cy", d => y(d.total_cases_2022_06_01))
          .attr("r", d => z(d.total_cases_pre_million_2022_06_01))
          .style("fill", "#69b3a2")
          .style("opacity", "0.7")
          .attr("stroke", "black")
    
    })
    
    </script>